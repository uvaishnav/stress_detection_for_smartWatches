<!DOCTYPE html>
<html>
<head>
    <title>Data Preparation Report</title>
    <link rel="stylesheet" href="assets/style.css">
    <script src="https://cdn.plot.ly/plotly-3.0.0.min.js" charset="utf-8"></script>
</head>
<body>
    <header>
        <h1>Data Preparation Report</h1>
        <div class="report-meta">
            <span class="generated-at">Generated: {{ report.generated_at }}</span>
            <span class="dataset-size">Total Records: {{ "{:,}".format(report.total_records) }}</span>
        </div>
    </header>
    
    <main>
        {% for section in report.sections %}
        <section class="report-section">
            <h2>{{ section.title }}</h2>
            
            {% if section.type == 'stats' %}
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Subjects</h3>
                    <p>{{ section.content.total_subjects }}</p>
                </div>
                <div class="stat-card">
                    <h3>Duration</h3>
                    <p>{{ "%.1f"|format(section.content.total_hours) }} hours</p>
                </div>
                <div class="stat-card">
                    <h3>Start Time</h3>
                    <p>{{ section.content.start_time }}</p>
                </div>
                <div class="stat-card">
                    <h3>End Time</h3>
                    <p>{{ section.content.end_time }}</p>
                </div>
            </div>
            
            {% elif section.type == 'quality' %}
            <div class="quality-metrics">
                <div class="missing-values">
                    <h3>Missing Values</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Column</th>
                                <th>Missing %</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for col, value in section.content.missing_values.items() %}
                            <tr>
                                <td>{{ col }}</td>
                                <td>{{ "%.2f"|format(value*100) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                <div class="out-of-range">
                    <h3>Out of Range Values</h3>
                    <table>
                        <tr>
                            <td>BVP</td>
                            <td>{{ "%.2f"|format(section.content.out_of_range.bvp*100) }}%</td>
                        </tr>
                        <tr>
                            <td>ACC</td>
                            <td>{{ "%.2f"|format(section.content.out_of_range.acc*100) }}%</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            {% elif section.type == 'visualization' %}
            <div class="visualizations">
                {% for name, fig in section.content.items() %}
                <div class="plot-container">
                    <div class="plot">{{ fig|safe }}</div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </section>
        {% endfor %}
    </main>
    
    <footer>
        <p>Generated by Unified Data Pipeline</p>
    </footer>
</body>
</html>